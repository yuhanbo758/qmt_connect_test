# QMT连接和数据下载测试工具 - 使用说明

## 概述

QMT连接和数据下载测试工具是一个基于Python和tkinter开发的图形用户界面应用程序，专门用于连接QMT（迅投量化交易终端）并进行数据下载、实时行情获取等操作。

## 主要功能

### 1. QMT连接管理
- **连接配置**: 设置QMT路径、账户ID和账户密钥
- **连接控制**: 连接/断开QMT服务
- **状态监控**: 实时显示连接状态和操作结果

### 2. 历史数据下载
- **单股票下载**: 支持指定股票代码下载历史数据
- **批量下载**: 支持Excel/文本文件导入股票列表进行批量下载
- **数据类型**: 支持1分钟、5分钟、15分钟、30分钟、1小时、日线数据
- **保存格式**: 支持CSV和Excel格式保存

### 3. 实时行情监控
- **实时价格**: 获取指定股票的最新价格
- **行情订阅**: 订阅实时行情数据推送
- **全推监控**: 监控全市场或自定义股票列表的涨跌幅变化
- **声音预警**: 支持系统提示音和自定义音效

### 4. 配置管理
- **自动保存**: 配置参数自动保存到JSON文件
- **配置重置**: 一键重置为默认配置
- **配置导入**: 支持手动编辑配置文件

## 界面说明

### 连接管理标签页
1. **QMT配置区域**
   - QMT路径: 设置QMT安装目录下的userdata_mini路径
   - 账户ID: 输入QMT账户ID
   - 账户密钥: 输入账户密钥（可选）

2. **连接控制区域**
   - 连接QMT: 建立与QMT的连接
   - 断开连接: 断开当前连接
   - 查询资产: 查询账户资产信息
   - 查询持仓: 查询当前持仓情况

3. **连接状态区域**
   - 显示连接状态和操作结果

### 数据下载标签页
1. **股票代码**: 输入要下载的股票代码（如：000001.SZ）
2. **数据类型**: 选择K线数据的时间周期
3. **时间范围**: 设置下载数据的起始和结束日期
4. **保存格式**: 选择CSV或Excel格式
5. **保存路径**: 设置数据保存目录

### 批量下载标签页
1. **文件导入**: 支持从Excel或文本文件导入股票代码列表
2. **手动输入**: 手动输入多个股票代码（用逗号分隔）
3. **股票列表**: 显示待下载的股票列表
4. **批量控制**: 开始/停止批量下载，显示下载进度

### 实时行情标签页
1. **实时行情控制**
   - 股票代码: 设置要监控的股票
   - 获取最新价: 获取当前最新价格
   - 订阅/取消订阅: 管理实时行情订阅

2. **全推数据控制**
   - 涨幅阈值: 设置涨幅预警阈值
   - 跌幅阈值: 设置跌幅预警阈值
   - 预警声音: 启用/禁用声音提醒
   - 监控股票: 选择监控范围（全市场/自定义）

3. **实时数据显示**: 显示实时行情数据和预警信息

### 帮助与配置标签页
1. **文档**: 查看使用说明和README文档
2. **配置管理**: 保存、重新加载、重置配置
3. **关于**: 显示软件版本和开发信息

## 使用步骤

### 首次使用
1. 启动程序后，首先在"连接管理"标签页配置QMT路径
2. 输入账户ID（账户密钥可选）
3. 点击"连接QMT"建立连接
4. 连接成功后即可使用各项功能

### 下载历史数据
1. 切换到"数据下载"标签页
2. 输入股票代码（如：000001.SZ）
3. 选择数据类型和时间范围
4. 设置保存路径和格式
5. 点击"下载数据"开始下载

### 批量下载
1. 切换到"批量下载"标签页
2. 通过文件导入或手动输入添加股票代码
3. 在股票列表中确认代码无误
4. 点击"开始批量下载"

### 实时监控
1. 切换到"实时行情"标签页
2. 设置监控参数（涨跌幅阈值、声音等）
3. 点击"开始全推监控"
4. 在实时数据显示区域查看监控结果

## 注意事项

1. **QMT连接**: 确保QMT客户端已启动并登录
2. **路径设置**: QMT路径应指向userdata_mini目录
3. **网络连接**: 确保网络连接正常，以获取实时数据
4. **数据格式**: 股票代码格式为"代码.交易所"（如：000001.SZ）
5. **文件权限**: 确保程序有读写配置文件和数据文件的权限

## 常见问题

### Q: 连接QMT失败怎么办？
A: 检查以下几点：
- QMT客户端是否已启动并登录
- QMT路径设置是否正确
- 账户ID是否正确
- 网络连接是否正常

### Q: 下载数据失败怎么办？
A: 可能的原因：
- 股票代码格式不正确
- 时间范围设置有误
- 网络连接问题
- QMT连接已断开

### Q: 实时监控没有数据怎么办？
A: 检查：
- QMT连接状态
- 股票代码是否正确
- 是否在交易时间内
- 网络连接是否稳定

### Q: 配置丢失怎么办？
A: 程序会自动保存配置到qmt_config.json文件，如果配置丢失：
- 检查配置文件是否存在
- 使用"重置配置"功能恢复默认设置
- 重新手动配置各项参数

## 技术支持

如遇到其他问题，请检查：
1. 日志输出区域的错误信息
2. QMT客户端的连接状态
3. 网络连接是否正常
4. 程序是否有足够的系统权限

## 更新日志

### v1.0.0
- 初始版本发布
- 支持QMT连接和数据下载
- 实现实时行情监控
- 添加配置管理功能
- 支持JSON格式配置文件